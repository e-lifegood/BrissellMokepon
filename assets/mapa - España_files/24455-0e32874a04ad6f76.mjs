(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[24455],{224455:(e,t,n)=>{n.d(t,{Z:()=>z});var i=n(667294),s=n(702664),r=n(898781),o=n(883119),a=n(785893);function l(e){const t=(0,r.ZP)(),{viewType:n,boardId:i,handleTouch:s}=e,l=t._('Board', 'createMenuLinkButton.Create.Board.Label', 'label for creating a new board option'),c=t._('Section', 'createMenuLinkButton.Create.Section.Label', 'label for creating a new section option');return 5===n&&i?(0,a.jsx)(o.iP,{role:"link",href:`/board/${i}/create_section/`,rounding:2,onTap:s,children:(0,a.jsx)(o.xu,{paddingY:2,"data-test-id":"addSectionButton",children:(0,a.jsx)(o.X6,{size:"400",children:c})})}):(0,a.jsx)(o.iP,{role:"link",onTap:s,href:"/board/create/",children:(0,a.jsx)(o.xu,{paddingY:2,"data-test-id":"createMenuCreateBoardButton",children:(0,a.jsx)(o.X6,{size:"400",children:l})})})}var c=n(276775),d=n(741740);function h({disabledPinCreation:e,handleDisablePublish:t,handleTouch:n}){const i=(0,r.ZP)(),s=(0,c.useHistory)(),l=e=>({base64Image:e,method:d.I}),h=i._('Photo', 'createPinButton.Photo.Upload.Label', 'label to upload pin from camera roll photos');return(0,a.jsx)(o.iP,{tapStyle:"none",onTap:()=>{e?t():n()},children:(0,a.jsxs)(o.xu,{position:"relative",paddingY:2,children:[(0,a.jsx)(o.X6,{size:"400",children:h}),e?null:(0,a.jsx)("input",{id:"upload-pin",type:"file",accept:"image/*",onChange:e=>{const t=new FileReader;t.readAsDataURL(e.target.files[0]),t.onload=()=>{const e=t.result;s.push({pathname:`/pin/create/${d.I}/`,state:l(String(e))})}},style:{opacity:0,position:"absolute",top:"0px",height:"100%",width:"100%"}})]})})}var u=n(121151);function p({isOpen:e,onDismiss:t}){const n=(0,r.ZP)();return(0,a.jsx)(u.ZP,{accessibilityModalLabel:n._('Disabled Pin Publishing Error Message Modal', 'disabledPinCreationModal.modal.accessibilityLabel', 'Label for disabled pin creation modal'),isOpen:e,mobileAccessibilityCloseIconLabel:n._('Close disabled publishing message modal', 'disabledPinCreationModal.modal.closeIconLabel', 'Label for the close button on the disabled publishing modal'),onDismiss:t,type:"DisabledPublishingModal",children:(0,a.jsxs)(o.xu,{alignItems:"center",direction:"column",display:"flex",paddingX:6,paddingY:4,children:[(0,a.jsx)(o.X6,{children:n._('Oops...', 'disabledPinCreationModal.modal.heading', 'Exclamation used to show recognition of a mistake.')}),(0,a.jsx)(o.xu,{paddingY:3,children:(0,a.jsx)(o.xv,{children:n._('Our server is experiencing a mild case of the hiccups at the moment. Please try refreshing and publishing again later.', 'disabledPinCreationModal.modal.text', 'Message to let users know there is an error.')})}),(0,a.jsx)(o.xu,{paddingY:3,children:(0,a.jsx)(o.zx,{color:"red",onClick:()=>t(),size:"lg",text:n._('Dismiss', 'disabledPinCreationModal.button.dismiss', 'Button text for closing the disabled pin creation modal')})})]})})}var _=n(941646),m=n(500594),g=n(134906),P=n(773285),b=n(112690),f=n(728214),x=n(859704);function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const w=e=>{const t=window&&window.innerWidth||0,n=e._('Enter a link to create a Pin, https://...', 'placeholder in text field where a user inputs a URL to create a Pin', 'placeholder in text field where a user inputs a URL to create a Pin'),i=e._('Enter a link, https://...', 'placeholder in text field where a user inputs a URL to create a Pin - short version, 30 char limit', 'placeholder in text field where a user inputs a URL to create a Pin - short version, 30 char limit');return t<380?i:n};class A extends i.PureComponent{constructor(...e){super(...e),C(this,"state",{createPinFromLinkUrl:"",showCreateModal:!1,showInlineTextEditCreatePin:!1,showPublishingDisabledError:!1,urlValidationError:null}),C(this,"createPinFromLinkInput",(0,i.createRef)()),C(this,"closeCreateModal",(()=>{this.setState({showCreateModal:!1,showInlineTextEditCreatePin:!1}),this.props.updatePinBuilderInput({isInputOpen:!1,submittedLink:""})})),C(this,"clearValidationError",(()=>{this.setState({urlValidationError:null})})),C(this,"openCreateModal",(e=>{this.handleTouch(),this.props.requireAuthForLimitedLogin({fn:()=>this.setState({showCreateModal:!0}),modalHeader:(0,m.is)(this.props.i18n)})()})),C(this,"handleCreatePinFromLinkTouch",(()=>{this.setState({showInlineTextEditCreatePin:!0}),this.props.updatePinBuilderInput({isInputOpen:!0})})),C(this,"handleDisablePublish",(()=>{this.setState({showCreateModal:!1,showPublishingDisabledError:!0})})),C(this,"handleLinkFieldChange",(({value:e})=>{this.setState({createPinFromLinkUrl:e})})),C(this,"handlePinFromLinkFormSubmit",((e,t)=>{const{createPinFromLinkUrl:n}=this.state;e.preventDefault();const{errors:i}=(0,g.Jx)({message:this.props.i18n._('Oops! Please enter a valid URL.', 'URL validation error message on Pin builder form', 'URL validation error message on Pin builder form')})(n),[s]=i;s?this.setState({urlValidationError:s}):this.handleUrlValidationSuccess(t)})),C(this,"handleTouch",(()=>{const{logContextEvent:e,viewType:t,elementType:n}=this.props;e({view_type:t,view_parameter:3106,element:n,event_type:102})})),C(this,"handleUrlValidationSuccess",(e=>{this.setState({showInlineTextEditCreatePin:!1});const t=this.state.createPinFromLinkUrl;this.props.updatePinBuilderInput({submittedLink:t}),e.push({pathname:"/pin-builder/",state:{createPinFromLinkUrl:t}}),this.closeCreateModal()})),C(this,"renderCreatePinFromLinkOption",(()=>{const{disabledPinCreation:e,history:t}=this.props,{createPinFromLinkUrl:n,showInlineTextEditCreatePin:i}=this.state,s=this.props.i18n._('Website', 'editPin.CreatePinFromUrl.Label', 'label for option to create a pin from a url');return(0,a.jsx)(o.kC,{alignItems:"center",height:46,justifyContent:"start",children:i?(0,a.jsx)("form",{onSubmit:e=>this.handlePinFromLinkFormSubmit(e,t),style:{width:"100%"},children:(0,a.jsxs)(o.xu,{display:"flex",justifyContent:"between",position:"relative",children:[(0,a.jsxs)(o.xu,{ref:this.createPinFromLinkInput,width:"100%",children:[this.renderErrorFlyout(),(0,a.jsx)(o.nv,{id:"create-pin-from-link",onChange:this.handleLinkFieldChange,onFocus:()=>this.setState({urlValidationError:null}),placeholder:w(this.props.i18n),size:"lg",value:n})]}),(0,a.jsx)(o.hU,{accessibilityLabel:this.props.i18n._('Create Pin from entered link', 'navigation button to confirm user will create a Pin from a link they entered', 'navigation button to confirm user will create a Pin from a link they entered'),iconColor:"darkGray",icon:"arrow-forward",onClick:({event:e})=>this.handlePinFromLinkFormSubmit(e,t),size:"lg"})]})}):(0,a.jsx)(o.iP,{onTap:()=>{e?this.handleDisablePublish():this.handleCreatePinFromLinkTouch()},tapStyle:"none",children:(0,a.jsx)(o.xu,{position:"relative","data-test-id":"websiteButton",children:(0,a.jsx)(o.X6,{size:"400",children:s})})})})})),C(this,"renderErrorFlyout",(()=>{const{urlValidationError:e}=this.state;return e&&(0,a.jsx)(o.J2,{anchor:this.createPinFromLinkInput.current,color:"red",idealDirection:"up",onDismiss:this.clearValidationError,size:"sm",children:(0,a.jsx)(o.xu,{padding:3,width:"100%",children:(0,a.jsx)(o.xv,{align:"center",color:"inverse",weight:"bold",children:e})})})}))}componentDidMount(){const{isInputOpen:e,submittedLink:t}=this.props;(e||t)&&this.setState({showCreateModal:!!e,showInlineTextEditCreatePin:!!e,createPinFromLinkUrl:t||""})}render(){const{bgColor:e,boardId:t,buttonPadding:n,disabledPinCreation:s,i18n:r,iconButtonColor:c="gray",iconButtonSize:d="xl",viewType:m}=this.props,{showCreateModal:g,showPublishingDisabledError:P}=this.state;let b=this.props.i18n._('Add a Pin or board', 'heading in profile create modal', 'heading in profile create modal');164===m?b=this.props.i18n._('Add to section', 'heading in section create modal', 'heading in section create modal'):5===m&&(b=this.props.i18n._('Add a Pin or section', 'heading in profile create modal', 'heading in profile create modal')||r._('Add to board', 'heading in board create modal', 'heading in board create modal'));const f=4===m?this.props.i18n._('Add to profile', 'editPin.AddToProfile.Modal.Header', 'heading in profile create modal'):b;return(0,a.jsxs)(i.Fragment,{children:[(0,a.jsx)(o.kC,{alignItems:"center",justifyContent:"start",children:(0,a.jsx)(_.Z,{id:"createMenuCreateButton",children:(0,a.jsx)(o.hU,{accessibilityLabel:this.props.i18n._('Create a Pin or board', 'icon that opens model prompting user to create a new pin or board', 'icon that opens model prompting user to create a new pin or board'),bgColor:e,iconColor:c,icon:"add",size:d,padding:"auto"!==n?n:1,onClick:({event:e})=>this.openCreateModal(e)})})}),g&&(0,a.jsx)(u.ZP,{mobileAccessibilityCloseIconLabel:this.props.i18n._('close board and pin create modal', 'close modal that prompts user to create a new pin or board', 'close modal that prompts user to create a new pin or board'),accessibilityModalLabel:"",heading:f,isOpen:this.state.showCreateModal,onDismiss:this.closeCreateModal,type:"create_menu",children:(0,a.jsx)(o.xu,{padding:3,children:(0,a.jsxs)(o.kC,{alignItems:"stretch",justifyContent:"start",direction:"column",children:[(0,a.jsxs)(i.Fragment,{children:[(0,a.jsxs)(o.xu,{paddingX:2,children:[(0,a.jsx)(o.xv,{children:this.props.i18n._('Create', 'editPin.Create.Section.Text', 'Section title to Create new things on Edit Pin add modal')}),(0,a.jsx)(i.Fragment,{children:this.renderCreatePinFromLinkOption()}),(0,a.jsx)(h,{disabledPinCreation:s,handleDisablePublish:this.handleDisablePublish,handleTouch:this.handleTouch})]}),164!==m&&(0,a.jsxs)(o.xu,{marginTop:6,paddingX:2,children:[(0,a.jsx)(o.xv,{children:this.props.i18n._('Add', 'editPin.Section.Add.Text', 'Section Add title on Edit Pin add modal')}),(0,a.jsx)(l,{boardId:t,handleTouch:()=>{this.handleTouch(),this.closeCreateModal()},viewType:m})]})]}),(0,a.jsx)(o.xu,{display:"flex",justifyContent:"center",marginBottom:2,marginTop:7,children:(0,a.jsx)(o.zx,{onClick:()=>this.closeCreateModal(),size:"lg",text:this.props.i18n._('Close', 'editPin.Modal.Close.Button', 'Button text to close modal on EditPin')})})]})})}),P&&(0,a.jsx)(p,{isOpen:!0,onDismiss:()=>{this.setState({showPublishingDisabledError:!1})}})]})}}function z(e){const t=(0,r.ZP)(),{checkExperiment:n}=(0,P.F)(),i=["disable_all","disable_web_pins"].includes(n("disable_pin_creation").group),o=(0,s.useDispatch)(),l=(0,c.useHistory)(),{pinBuilder:d}=(0,s.useSelector)((e=>e.session)),h=(0,b.Z)(),u=d&&d.isInputOpen,p=d&&d.submittedLink,_=(0,f.Z)();return(0,a.jsx)(A,{...e,disabledPinCreation:i,history:l,i18n:t,isInputOpen:u,logContextEvent:h,requireAuthForLimitedLogin:_,submittedLink:p,updatePinBuilderInput:e=>o((0,x.p)(e))})}},741740:(e,t,n)=>{n.d(t,{I:()=>i,y:()=>s});const i="uploaded",s="pinbuilder"},859704:(e,t,n)=>{n.d(t,{F:()=>s,p:()=>r});var i=n(983360);const s=e=>({type:i.q,payload:e}),r=e=>({type:i.GG,payload:e})},134906:(e,t,n)=>{n.d(t,{Bh:()=>d,C9:()=>x,CB:()=>p,CU:()=>o,FU:()=>j,GT:()=>a,Gy:()=>g,J_:()=>z,Jx:()=>_,MZ:()=>P,VC:()=>u,VG:()=>l,ZA:()=>c,Zt:()=>m,a3:()=>k,aH:()=>r,h7:()=>A,nw:()=>f,oR:()=>C,qA:()=>h,qp:()=>y,sG:()=>b,vd:()=>L,xk:()=>w});var i=n(89254);const s=e=>{const t={"０":"0","１":"1","２":"2","３":"3","４":"4","５":"5","６":"6","７":"7","８":"8","９":"9","　":" "},n=String(e).split("");return n.forEach(((e,i)=>{const s=t[e];s&&(n[i]=s)})),n.join("")};function r(e){return function(t,n){const i=[];t&&/\S/.test(t)||i.push(e.message);const s={errors:i,warnings:[]};return n&&n(s),s}}const o=new RegExp(["(^[-!#$%&'*+/=?^_`{}|~0-9A-Z]+(\\.[-!#$%&'*+/=?^_`{}|~0-9A-Z]+)*",'|^"([\\001-\\010\\013\\014\\016-\\037!#-\\[\\]-\\177]|\\\\[\\001-\\011\\013\\014\\016-\\177])*"',")@((?:[A-Z0-9](?:[A-Z0-9-]{0,61}[A-Z0-9])?\\.)+[A-Z]{2,20}$)","|\\[(25[0-5]|2[0-4]\\d|[0-1]?\\d?\\d)(\\.(25[0-5]|2[0-4]\\d|[0-1]?\\d?\\d)){3}\\]$"].join(""),"i");function a(e){return function(t,n){const i=[];(t=t&&t.trim())&&!t.match(o)&&i.push(e.message);const s={errors:i,warnings:[]};return n&&n(s),s}}function l(e){return function(t,n){const i=[];(t=t&&t.trim())&&!t.match(/^[^0-9].*$/)&&i.push(e.message);const s={errors:i,warnings:[]};return n&&n(s),s}}function c(e){return function(t,n){const i=[];if(t){const n=parseInt(t,10);Number.isNaN(n)?i.push(e.invalidAgeString):(e.ageTooShortString&&n<10&&i.push(e.ageTooShortString),n<=0||n>120?i.push(e.invalidAgeString):e.checkUnderAgeWithString&&n<13&&i.push(e.checkUnderAgeWithString))}const s={errors:i,warnings:[]};return n&&n(s),s}}function d(e){return function(t,n){const i=(t=t&&t.trim()).replace(/[\(\)\+\-\. ]/g,""),s=[],r=!1!==e.checkLength&&i.length<7;!t||t.match(/^(\(?\+?[0-9]*\)?)?[0-9_\- \.\(\)]*$/g)&&!r||s.push(e.message);const o={errors:s,warnings:[]};return n&&n(o),o}}function h(e){return function(t,n){const i=/^\d+$/,r=[];"number"==typeof t||"string"==typeof t&&(t=t&&t.trim(),(t=s(t))&&!t.match(i)&&r.push(e.message));const o={errors:r,warnings:[]};return n&&n(o),o}}function u(e){return function(t,n){const i=/^[\d\ -]+$/,r=[];"number"==typeof t||"string"==typeof t&&(t=t&&t.trim(),(t=s(t))&&!t.match(i)&&r.push(e.message));const o={errors:r,warnings:[]};return n&&n(o),o}}const p=e=>!!e.match(/^(https?:\/\/){0,1}[a-z0-9_\-]+\..+/gi);function _(e){return function(t,n){const i=[];t&&!p(t)&&i.push(e.message);const s={errors:i,warnings:[]};return n&&n(s),s}}function m(e){return function(t,n){const s=[];if(t)try{const n=(0,i.Z)(t);n&&n.protocol&&("http"!==n.protocol||"localhost"===n.hostname)||s.push(e.message)}catch(o){s.push(e.message)}const r={errors:s,warnings:[]};return n&&n(r),r}}function g(e){return function(t,n){const i=[];(e.should_trim||!1)&&(t=t&&t.trim());const s=t.length;e.min&&s<e.min?i.push(e.minErrorString):e.max&&s>e.max&&i.push(e.maxErrorString);const r={errors:i,warnings:[]};return n&&n(r),r}}function P(e){return function(t,n){const i=!e.checkExclusion,s=e.substrings,r=[];(i&&!s.some((e=>t.includes(e)))||!i&&s.some((e=>t.includes(e))))&&r.push(e.message);const o={errors:r,warnings:[]};return n&&n(o),o}}function b(e){return function(t,n){const i=[];t!==(e&&e.targetValue)&&i.push(e.message);const s={errors:i,warnings:[]};return n&&n(s),s}}function f(e){return function(t,n){const i=[];(t?parseFloat(t):0)<e.value&&i.push(e.message);const s={errors:i,warnings:[]};return n&&n(s),s}}function x(e){return function(t,n){const i=new Date(t),s=[];e.date instanceof Date&&i instanceof Date&&e.date<i&&s.push(e.message);const r={errors:s,warnings:[]};return n&&n(r),r}}function C(e){return function(t,n){const i=[];/^[\040-\176]*$/.test(t)||i.push(e.message);const s={errors:i,warnings:[]};return n&&n(s),s}}function w(e){return function(t,n){let i=2;if(e.hasFractionalCents)i=3;else if(e.currencyCode){const{maximumFractionDigits:t}=new Intl.NumberFormat(void 0,{style:"currency",currency:e.currencyCode}).resolvedOptions();i=t}const s=new RegExp(i?`^\\d*(\\.\\d{1,${i}})?$`:"^\\d*$"),r=[];"number"==typeof t&&(t=t.toString()),t&&!t.match(s)&&(t=t&&t.trim(),r.push(e.message));const o={errors:r,warnings:[]};return n&&n(o),o}}function A(e){return function(t,n){const i=[];Number(t)>=1e13&&i.push(e.message);const s={errors:i,warnings:[]};return n&&n(s),s}}function z(e){return function(t,n){t=t&&t.trim();const i=[],s=new Date(t);t&&!s.getTime()&&i.push(e.message);const r={errors:i,warnings:[]};return n&&n(r),r}}function y(e){return function(t,n){const i=t&&t.trim(),s=[];i&&!i.match(/^([01]?[0-9]|2[0-3]):[0-5][0-9]$/)&&s.push(e.message);const r={errors:s,warnings:[]};return n&&n(r),r}}function L(e){return function(t,n){const i=[];e.pattern.test(t)||i.push(e.message);const s={errors:i,warnings:[]};return n&&n(s),s}}function j(e,t){const n=e.map((e=>e(t).errors));return[].concat(...n)}function k(e,t){let n="";return t.some((t=>{const i=t(e);return i.errors.length>0&&(n=i.errors[0],!0)})),n}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/24455-0e32874a04ad6f76.mjs.map